{% extends "products/base.html" %}
{% block title %}–ö–∞—Ç–∞–ª–æ–≥ —Ç–æ–≤–∞—Ä–æ–≤{% endblock %}

{% block filters %}
<div class="card shadow-sm">
    <div class="card-body">
        <h5 class="card-title mb-3">–§–∏–ª—å—Ç—Ä—ã</h5>
        <form method="get">
            <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
            <input type="text" class="form-control mb-3" name="name"
                   value="{{ request.GET.name }}" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: Lenovo">

            <label class="form-label">–ú–∞–≥–∞–∑–∏–Ω</label>
            <select class="form-select mb-3" name="store">
                <option value="">–õ—é–±–æ–π</option>
                <option value="WebScraper Test" {% if request.GET.store == "WebScraper Test" %}selected{% endif %}>WebScraper Test</option>
                <option value="Amazon">Amazon</option>
            </select>

            <label class="form-label">–¶–µ–Ω–∞ –¥–æ (—Ä—É–±)</label>
            <input type="number" class="form-control mb-3" name="max_price"
                   value="{{ request.GET.max_price }}">

            <button class="btn btn-dark w-100" type="submit">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <a href="{% url 'index' %}" class="btn btn-outline-secondary w-100 mt-2">–°–±—Ä–æ—Å–∏—Ç—å</a>
        </form>
    </div>
</div>
{% endblock %}

{% block content %}
<h2 class="mb-4 fw-bold">üéß –í—Å–µ —Ç–æ–≤–∞—Ä—ã</h2>

<div class="row g-4">
    {% for p in products %}
    <div class="col-12 col-sm-6 col-md-4 col-lg-3">
        <div class="card shadow-sm border-0 h-100">
            <img src="{{ p.image_url }}" class="card-img-top p-3" alt="{{ p.title }}" style="max-height: 200px; object-fit: contain;">
            
            <div class="card-body d-flex flex-column">
                <h6 class="card-title fw-bold">{{ p.title|truncatechars:40 }}</h6>
                
                <p class="text-success fw-bold fs-5">{{ p.price }} —Ä—É–±</p>
                
                <p class="text-muted small mb-2">
                    <i class="bi bi-shop"></i> {{ p.store }}
                </p>
                
                <p class="small text-muted mb-3">{{ p.description|truncatechars:60 }}</p>
                
                <a href="{% url 'product_detail' p.id %}" class="btn btn-primary w-100 mt-auto mb-2">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                <a href="{% url 'add_to_cart' p.id %}" class="btn btn-outline-dark w-100">–í –∫–æ—Ä–∑–∏–Ω—É</a>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% if not products %}
<div class="alert alert-warning mt-3" role="alert">
  –ù–µ—Ç —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ –∑–∞–¥–∞–Ω–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–∞–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã.
</div>
{% endif %}
{% endblock %}